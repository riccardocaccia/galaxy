---
- hosts: galaxyservers
  become: true
  become_user: root
  vars_files:             
    - group_vars/secret.yml

  pre_tasks:
    - name: Include tasks for CentOS7
      import_tasks: pretasks_centos.yml
      when: ansible_distribution == 'CentOS'

    - name: Include tasks for RockyLinux9
      import_tasks: pretasks_rockylinux9.yml
      when: ansible_distribution == "Rocky"

    - name: Update ca-certificates
      yum:
        name: ca-certificates
        state: latest

    - name: Put SELinux in permissive mode.
      selinux:
        policy: targeted
        state: permissive

  roles:
    - galaxyproject.postgresql
    - galaxyproject.postgresql_objects
    - geerlingguy.pip
    - galaxyproject.galaxy
    - galaxyproject.miniconda
    - galaxyproject.nginx
    - galaxyproject.tusd
    - usegalaxy_eu.certbot   
